<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Loki CNN: src/fully_connected_layer.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Loki CNN
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fully_connected_layer.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>FC layer.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="layer_8h_source.html">layer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="math__functions_8h_source.html">math_functions.h</a>&quot;</code><br />
</div>
<p><a href="fully__connected__layer_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:acda77f28c85b289bb787d3c78e0c51aa"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structLayer.html">Layer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fully__connected__layer_8h.html#acda77f28c85b289bb787d3c78e0c51aa">fc_layer_t</a></td></tr>
<tr class="separator:acda77f28c85b289bb787d3c78e0c51aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aed008ae3fe5189b555fc57a0b2fe5207"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fully__connected__layer_8h.html#aed008ae3fe5189b555fc57a0b2fe5207">fc_forward</a> (const <a class="el" href="fully__connected__layer_8h.html#acda77f28c85b289bb787d3c78e0c51aa">fc_layer_t</a> *l, const <a class="el" href="data__structure_8h.html#a051bd2b17d42e70d86b4314e0dd8881e">vol_t</a> **<a class="el" href="max__pooling__layer__MultiCore_8h.html#ab943d53559ea6283e896bd8bf603b626">in</a>, <a class="el" href="data__structure_8h.html#a051bd2b17d42e70d86b4314e0dd8881e">vol_t</a> **<a class="el" href="max__pooling__layer__MultiCore_8h.html#abc600ae3097d3509f83258671cf3701e">out</a>, const int <a class="el" href="max__pooling__layer__MultiCore_8h.html#a79cb7003c3528d3096592502cbd07fb9">start</a>, const int <a class="el" href="max__pooling__layer__MultiCore_8h.html#a3efd06bf9a5c88624e60c85040903747">end</a>)</td></tr>
<tr class="memdesc:aed008ae3fe5189b555fc57a0b2fe5207"><td class="mdescLeft">&#160;</td><td class="mdescRight">FC layer forward routine.  <a href="#aed008ae3fe5189b555fc57a0b2fe5207">More...</a><br /></td></tr>
<tr class="separator:aed008ae3fe5189b555fc57a0b2fe5207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fb2ac479851f37159b6bb76f77b3eb1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fully__connected__layer_8h.html#acda77f28c85b289bb787d3c78e0c51aa">fc_layer_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fully__connected__layer_8h.html#a1fb2ac479851f37159b6bb76f77b3eb1">make_fc_layer</a> (int in_sx, int in_sy, int in_depth, int out_depth)</td></tr>
<tr class="memdesc:a1fb2ac479851f37159b6bb76f77b3eb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor of fully connected layer  <a href="#a1fb2ac479851f37159b6bb76f77b3eb1">More...</a><br /></td></tr>
<tr class="separator:a1fb2ac479851f37159b6bb76f77b3eb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dbba49846ec688f51a7db35d3694a84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fully__connected__layer_8h.html#a4dbba49846ec688f51a7db35d3694a84">fc_load</a> (<a class="el" href="fully__connected__layer_8h.html#acda77f28c85b289bb787d3c78e0c51aa">fc_layer_t</a> *l, const int *params, const <a class="el" href="setting_8h.html#ac7889bf9b3596f63c57011af217212dd">weight_t</a> *weights)</td></tr>
<tr class="memdesc:a4dbba49846ec688f51a7db35d3694a84"><td class="mdescLeft">&#160;</td><td class="mdescRight">default fully connected layer weight loader  <a href="#a4dbba49846ec688f51a7db35d3694a84">More...</a><br /></td></tr>
<tr class="separator:a4dbba49846ec688f51a7db35d3694a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>FC layer. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="acda77f28c85b289bb787d3c78e0c51aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="structLayer.html">Layer</a> <a class="el" href="fully__connected__layer_8h.html#acda77f28c85b289bb787d3c78e0c51aa">fc_layer_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aed008ae3fe5189b555fc57a0b2fe5207"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fc_forward </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="fully__connected__layer_8h.html#acda77f28c85b289bb787d3c78e0c51aa">fc_layer_t</a> *&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="data__structure_8h.html#a051bd2b17d42e70d86b4314e0dd8881e">vol_t</a> **&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="data__structure_8h.html#a051bd2b17d42e70d86b4314e0dd8881e">vol_t</a> **&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>FC layer forward routine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">l</td><td>the FC layer pointer </td></tr>
    <tr><td class="paramname">in</td><td>the input images </td></tr>
    <tr><td class="paramname">out</td><td>the ouput images </td></tr>
    <tr><td class="paramname">start</td><td>the index in the input batch from which to perform forwarding </td></tr>
    <tr><td class="paramname">end</td><td>the index in the input batch from which to stop perform forwarding</td></tr>
  </table>
  </dd>
</dl>
<p>It is not difficult to see that FC layer is by nature matrix-vector multiplication, hence calling gemv is default </p>

</div>
</div>
<a class="anchor" id="a4dbba49846ec688f51a7db35d3694a84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fc_load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fully__connected__layer_8h.html#acda77f28c85b289bb787d3c78e0c51aa">fc_layer_t</a> *&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="setting_8h.html#ac7889bf9b3596f63c57011af217212dd">weight_t</a> *&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>default fully connected layer weight loader </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">l</td><td>pointer to the FC layer </td></tr>
    <tr><td class="paramname">params</td><td>specifiers of FC layer parameters, used to track whether the weight file matches the layer's requirement </td></tr>
    <tr><td class="paramname">weights</td><td>pointer to the starting point of weight array</td></tr>
  </table>
  </dd>
</dl>
<p>this is just one way of loading values, one can easily define its own loader according to specific needs for loading from weights trained by caffe, this is an easy approach </p>

</div>
</div>
<a class="anchor" id="a1fb2ac479851f37159b6bb76f77b3eb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fully__connected__layer_8h.html#acda77f28c85b289bb787d3c78e0c51aa">fc_layer_t</a>* make_fc_layer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>in_sx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>in_sy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>in_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>out_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>constructor of fully connected layer </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in_sx</td><td>the width of input image </td></tr>
    <tr><td class="paramname">in_sy</td><td>the height of input image </td></tr>
    <tr><td class="paramname">in_depth</td><td>the channel number of input image </td></tr>
    <tr><td class="paramname">out_depth</td><td>the number of outputs </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
